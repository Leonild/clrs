(require-extension syntax-case check)
(require '../15.5/section)
(import section-15.5)
(let ((p (array-align (list->array 1 '(#f 0.15 0.10 0.05 0.10 0.20)) -1))
      (q (array-align (list->array 1 '(0.05 0.10 0.05 0.05 0.05 0.10)) -1)))
  (let-values (((e root) (memoized-bst p q)))
    (check (array->list e) =>
           '((#f #f #f #f #f #f #f)
             (0.05 0.45 0.9 1.25 1.75 2.75 #f)
             (#f 0.1 0.4 0.7 1.2 2.0 #f)
             (#f #f 0.05 0.25 0.6 1.3 #f)
             (#f #f #f 0.05 0.3 0.9 #f)
             (#f #f #f #f 0.05 0.5 #f)
             (#f #f #f #f #f 0.1 #f)))
    (check (array->list root) =>
           '((#f #f #f #f #f #f #f)
             (#f 0 0 1 1 3 #f)
             (#f #f 1 1 1 3 #f)
             (#f #f #f 2 3 4 #f)
             (#f #f #f #f 3 4 #f)
             (#f #f #f #f #f 4 #f)
             (#f #f #f #f #f #f #f)))))
