(require-extension syntax-case check)
(require '../srfi/srfi-70)
(require '../11.2/section)
(import* srfi-70 exact-floor)
(import section-11.2)
(let ((table
       (make-ch-table
        1000
        (lambda (key)
          (exact-floor (* 1000 (modulo (* key (/ (- (sqrt 5) 1) 2)) 1))))))
      (e1 (make-ch-element 61 61))
      (e2 (make-ch-element 62 62))
      (e3 (make-ch-element 63 63))
      (e4 (make-ch-element 64 64))
      (e5 (make-ch-element 65 65)))
  (ch-insert! table e1)
  (ch-insert! table e2)
  (ch-insert! table e3)
  (ch-insert! table e4)
  (ch-insert! table e5)
  (check (ch->list table) => '((172 (65 . 65))
                               (318 (62 . 62))
                               (554 (64 . 64))
                               (700 (61 . 61))
                               (936 (63 . 63)))))
